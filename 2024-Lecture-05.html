<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2024-01-01">

<title>(2024) Lecture 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-065a5179aebd64318d7ea99d77b64a9e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d3a565c23c4d3b0e7c030e96a8964f3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#kinematics-of-two-to-two-scattering-and-three-body-decays" id="toc-kinematics-of-two-to-two-scattering-and-three-body-decays" class="nav-link active" data-scroll-target="#kinematics-of-two-to-two-scattering-and-three-body-decays"><span class="header-section-number">0.1</span> Kinematics of Two-to-Two Scattering and Three-Body Decays</a></li>
  <li><a href="#kinematics-recap-22-scattering-processes" id="toc-kinematics-recap-22-scattering-processes" class="nav-link" data-scroll-target="#kinematics-recap-22-scattering-processes"><span class="header-section-number">1</span> Kinematics Recap: 2→2 Scattering Processes</a></li>
  <li><a href="#counting-kinematic-variables" id="toc-counting-kinematic-variables" class="nav-link" data-scroll-target="#counting-kinematic-variables"><span class="header-section-number">2</span> Counting Kinematic Variables</a></li>
  <li><a href="#choosing-the-two-variables" id="toc-choosing-the-two-variables" class="nav-link" data-scroll-target="#choosing-the-two-variables"><span class="header-section-number">3</span> Choosing the Two Variables</a></li>
  <li><a href="#scattering-amplitudes-and-spin-dependence" id="toc-scattering-amplitudes-and-spin-dependence" class="nav-link" data-scroll-target="#scattering-amplitudes-and-spin-dependence"><span class="header-section-number">4</span> Scattering Amplitudes and Spin Dependence</a></li>
  <li><a href="#extension-to-three-body-decays" id="toc-extension-to-three-body-decays" class="nav-link" data-scroll-target="#extension-to-three-body-decays"><span class="header-section-number">5</span> Extension to Three-Body Decays</a></li>
  <li><a href="#applications-and-homework" id="toc-applications-and-homework" class="nav-link" data-scroll-target="#applications-and-homework"><span class="header-section-number">6</span> Applications and Homework</a>
  <ul class="collapse">
  <li><a href="#decoding-the-λc-dalitz-plot" id="toc-decoding-the-λc-dalitz-plot" class="nav-link" data-scroll-target="#decoding-the-λc-dalitz-plot"><span class="header-section-number">6.1</span> Decoding the Λc Dalitz Plot</a></li>
  <li><a href="#dalitz-plot-kinematics-in-three-body-decay" id="toc-dalitz-plot-kinematics-in-three-body-decay" class="nav-link" data-scroll-target="#dalitz-plot-kinematics-in-three-body-decay"><span class="header-section-number">6.2</span> Dalitz Plot Kinematics in Three-Body Decay</a></li>
  <li><a href="#resonance-structures-and-angular-distributions-in-three-body-decays" id="toc-resonance-structures-and-angular-distributions-in-three-body-decays" class="nav-link" data-scroll-target="#resonance-structures-and-angular-distributions-in-three-body-decays"><span class="header-section-number">6.3</span> Resonance Structures and Angular Distributions in Three-Body Decays</a></li>
  <li><a href="#angular-distributions-and-partial-wave-analysis" id="toc-angular-distributions-and-partial-wave-analysis" class="nav-link" data-scroll-target="#angular-distributions-and-partial-wave-analysis"><span class="header-section-number">6.4</span> Angular Distributions and Partial Wave Analysis</a></li>
  <li><a href="#office-hours-arrangement" id="toc-office-hours-arrangement" class="nav-link" data-scroll-target="#office-hours-arrangement"><span class="header-section-number">6.5</span> Office Hours Arrangement</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(2024) Lecture 5</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Presenter</strong>: Mikhail Mikhasenko</p>
<p><strong>Note Taker</strong>: Anna Zimmer</p>
<section id="kinematics-of-two-to-two-scattering-and-three-body-decays" class="level3" data-number="0.1">
<h3 data-number="0.1" class="anchored" data-anchor-id="kinematics-of-two-to-two-scattering-and-three-body-decays"><span class="header-section-number">0.1</span> Kinematics of Two-to-Two Scattering and Three-Body Decays</h3>
<p>Today we are at lecture number five. We’ll discuss angular distributions and partial wave analysis.</p>
<p>But before going there I would like to start with a recap. The last lecture we discussed the phase space for particle reactions and we discussed different experiments and their kinematics. We went through the list of experiments around the world that study hadrons and look at their production mechanisms and some peculiarities.</p>
</section>
<section id="kinematics-recap-22-scattering-processes" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="kinematics-recap-22-scattering-processes"><span class="header-section-number">1</span> Kinematics Recap: 2→2 Scattering Processes</h2>
<p>We start with a recap on kinematics. The first question: how many variables does one need to describe the two-to-two scattering process? We have two particles in the initial state and two particles in the final state.</p>
<ul>
<li><p>Initial state: two 0⁻ scalar particles</p></li>
<li><p>Final state: two 0⁻ scalar particles</p></li>
<li><p>Example: 0⁻ + 0⁻ → 3⁻ + 1⁺ scattering</p></li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The “blob” in scattering diagrams represents the interaction region where strong, electromagnetic, or gravitational interactions occur. These are not Feynman diagrams but sometimes called unitarity diagrams.</p>
</div>
</div>
</div>
<p>The number of kinematic variables needed depends only on the external particles - whatever happens inside the interaction blob does not affect this count.</p>
</section>
<section id="counting-kinematic-variables" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="counting-kinematic-variables"><span class="header-section-number">2</span> Counting Kinematic Variables</h2>
<p>Let’s calculate systematically:</p>
<p><strong>Step 1: Initial counting</strong></p>
<ul>
<li>4 particles × 4 momentum components each = 16 variables</li>
</ul>
<p><strong>Step 2: Apply conservation laws</strong></p>
<ul>
<li>4-momentum conservation (E, pₓ, pᵧ, p₂) removes 4 constraints → 12 remaining variables</li>
</ul>
<p><strong>Step 3: Remove redundant degrees of freedom</strong></p>
<ul>
<li>3 rotations and 3 boosts can be eliminated → subtract 6 more variables</li>
</ul>
<p><strong>Final count: 2 independent variables</strong></p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Both scalar and spinning particle cases require <strong>only 2 variables</strong> to fully describe 2→2 scattering kinematics. The difference is that spinning particles have more scattering amplitudes, but all amplitudes still depend on the same 2 kinematic variables.</p>
</div>
</div>
</div>
</section>
<section id="choosing-the-two-variables" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="choosing-the-two-variables"><span class="header-section-number">3</span> Choosing the Two Variables</h2>
<p><strong>Primary Mandelstam variables:</strong> <span class="math display">s = (p_1 + p_2)^2 = (p_3 + p_4)^2</span> <span class="math display">t = (p_1 - p_3)^2</span> <span class="math display">u = (p_1 - p_4)^2</span></p>
<p>These variables are related by: <span class="math inline">s + t + u = \sum m_i^2</span>, so only two are independent.</p>
<p><strong>Physics meaning:</strong></p>
<ul>
<li><strong><span class="math inline">s</span></strong>: Total center-of-mass energy squared</li>
<li><strong><span class="math inline">t</span></strong>: Momentum transfer squared between particles 1 and 3</li>
<li><strong><span class="math inline">u</span></strong>: Alternative momentum transfer variable</li>
</ul>
<p><strong>Center of Mass Frame Variables:</strong></p>
<ul>
<li><span class="math inline">\sqrt{s}</span>: Center-of-mass energy</li>
<li><span class="math inline">\cos\theta_{CM}</span>: Scattering angle between initial and final state particles</li>
</ul>
<p><strong>Other possibilities:</strong></p>
<ul>
<li>Lab frame energies <span class="math inline">E_1</span> and <span class="math inline">E_3</span></li>
<li>Any two independent variables that characterize the process</li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Mandelstam variables are preferred because they are Lorentz invariant and provide an undistorted representation of phase space density. The transformation to these variables has a constant Jacobian.</p>
</div>
</div>
</div>
</section>
<section id="scattering-amplitudes-and-spin-dependence" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="scattering-amplitudes-and-spin-dependence"><span class="header-section-number">4</span> Scattering Amplitudes and Spin Dependence</h2>
<p><strong>For scalar particles:</strong> The scattering amplitude is a single scalar function <span class="math inline">A(s,t)</span></p>
<p><strong>For spinning particles:</strong> The scattering amplitude becomes a multi-component object:</p>
<ul>
<li>Spin-3 particle: 7 dimensions</li>
<li>Spin-1 particle: 3 dimensions</li>
<li>Total amplitude dimension: 7 × 3 = 21 components</li>
</ul>
<p>However, all 21 amplitudes are still functions of the same 2 variables (<span class="math inline">s</span> and <span class="math inline">t</span>).</p>
</section>
<section id="extension-to-three-body-decays" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="extension-to-three-body-decays"><span class="header-section-number">5</span> Extension to Three-Body Decays</h2>
<p>Now considering three-body decays (1 particle → 3 particles):</p>
<p><strong>Kinematic variables:</strong> Still 2 variables needed, same as 2→2 scattering</p>
<p><strong>Dalitz plot variables:</strong> Typically use two invariant mass squared variables: <span class="math display">m_{34}^2 = (p_3 + p_4)^2</span> <span class="math display">m_{24}^2 = (p_2 + p_4)^2</span></p>
<p><strong>Three-body phase space formula:</strong> <span class="math display">d\Phi_3 = d\Phi_2(m_{12}^2) \times d\Phi_2(m_{34}^2) \times \frac{dm_{34}^2}{2\pi}</span></p>
<p><strong>Two-body phase space element:</strong> <span class="math display">d\Phi_2 = \frac{1}{8\pi} \frac{2|\vec{p}|}{\sqrt{s}} \frac{d\Omega}{4\pi}</span></p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The phase space for three-body decay is <strong>flat</strong> when plotted against Mandelstam variables. (see Figure~1) This means the differential width directly reveals the dynamics of the interaction without kinematic distortions. (see Figure~2) (see Figure~3) (see Figure~6)</p>
</div>
</div>
</div>
</section>
<section id="applications-and-homework" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="applications-and-homework"><span class="header-section-number">6</span> Applications and Homework</h2>
<p>We will continue discussing angular distributions after the Dalitz plot. The homework exercise on Dalitz plots connects directly to hadron spectroscopy, which is the focus of upcoming lectures.</p>
<p><strong>Key realization:</strong> For any N-body process, once you specify the kinematic variables, you can completely reconstruct the “rigid body” configuration of all momentum vectors in the center-of-mass frame.</p>
<p>The recursive phase space formula demonstrates that the Jacobian for transformation to Mandelstam variables is constant, making these variables ideal for studying interaction dynamics through Dalitz plot analyses.</p>
<div id="fig-fg2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A sketch illustrating the recursive relation when computing the phase-space expression. This is not a dynamic assumption but a mathematical trick that rewrites the full three-body phase-space through lower-dimensional phase-space elements and the two-body phase-space, for which the expression is simple.
</figcaption>
</figure>
</div>
<section id="decoding-the-λc-dalitz-plot" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="decoding-the-λc-dalitz-plot"><span class="header-section-number">6.1</span> Decoding the Λc Dalitz Plot</h3>
<p>You can see the example of the triple decay that I have here of the <span class="math inline">\Lambda_c</span> baryon going to the proton, kaon, and pion: <span class="math display">\Lambda_c^+ \to p + K^- + \pi^+</span></p>
<p>We measure <span class="math inline">\Lambda_c</span> produced in proton-proton collisions or any other collisions. In experiments, they observe <span class="math inline">\Lambda_c</span> abundantly. This is one of the particles that lives long enough and is produced copiously.</p>
<p>Particles with charm ground states are produced abundantly and live sufficiently long to fly from the primary vertex. That’s why we have a good sample and a good understanding of their decay kinematics—not only kinematics, but dynamics as well. (see Figure~6)</p>
<p>In this decay, there is a charm quark in the initial state and no charm quark in the final state, indicating that this occurs via <strong>weak interaction</strong>. The charm quark disappears between initial and final states: the charm quark decays, transitioning into a strange quark that ends up in the kaon. This <span class="math inline">c \to s</span> transition happens within one generation and is <strong>not suppressed</strong>—it is an allowed process.</p>
<p>This decay is considered a <strong>golden channel</strong> for detection because:</p>
<ul>
<li>The final state contains three charged particles—there are no neutrals.</li>
<li>The proton is charged, travels well, and is stable.</li>
<li>The kaon and pion are stable in our accelerator experiments.</li>
</ul>
<p>These particles fly from the decay without distraction, and we see their tracks clearly through all detectors. They point away from the primary interaction vertex.</p>
<p>There is roughly a <strong>1 cm shift</strong> between the primary vertex and the secondary vertex in <span class="math inline">\Lambda_c</span> decays. This displacement occurs due to the boost and the fact that <span class="math inline">\Lambda_c</span> lives longer in the laboratory frame than in its rest frame.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The decay length in the laboratory frame is given by: <span class="math display">L = \beta\gamma c\tau</span> At the LHC, <span class="math inline">\Lambda_c</span> is produced with energies of a few hundred GeV, making this decay particularly clean and well-suited for study.</p>
</div>
</div>
</div>
<p>We have studied this decay extensively. Here is the result of an analysis that resembles experimental data. If I showed you actual experimental data, you wouldn’t distinguish it from this plot—the statistics are so high that the distribution appears very smooth.</p>
<ul>
<li>On the <strong>x-axis</strong>: invariant mass of the proton and kaon, <span class="math inline">m_{12}^2</span></li>
<li>On the <strong>y-axis</strong>: invariant mass of the kaon and pion, <span class="math inline">m_{23}^2</span></li>
</ul>
<p>All allowed kinematic values for the decay are shown in color. (see Figure~6) The white area corresponds to kinematics where no physical configuration exists—energy and momentum cannot be conserved there.</p>
<p>If you select a point inside the colored region, you can compute angles between particles and reproduce the configuration with a 3D-printed rigid body. But if you choose a point in the white region, you quickly find that energy conservation cannot be satisfied.</p>
<p>The range of possible values for the invariant masses is limited, and this surface is called the <strong>Dalitz plot</strong>. The kinematic boundaries are defined by:</p>
<p><span class="math display">m_{12}^2 + m_{23}^2 + m_{13}^2 = m_{\Lambda_c}^2 + m_p^2 + m_K^2 + m_{\pi}^2</span></p>
<p>Different colors in the plot indicate different probabilities for the decay to occur at that kinematic point. (see Figure~6) The differential decay rate in the Dalitz plot is:</p>
<p><span class="math display">\frac{d^2\Gamma}{dm_{12}^2  dm_{23}^2} \propto |\mathcal{M}|^2</span></p>
<p>We measure the decay by reconstructing particle tracks and identifying from which kinematic point the decay originated. There is an unambiguous relation between four-vectors and kinematic points. (see Figure~3)</p>
<p>It turns out that certain kinematics are more probable than others—particles prefer specific directions. For example, one configuration may be more common, while another is rare. On the border of the Dalitz plot, particles are aligned in one line, whereas inside the surface they always have an angle between them.</p>
<p>Think about how to maximize the invariant mass and where on the border such a point lies.</p>
</section>
<section id="dalitz-plot-kinematics-in-three-body-decay" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="dalitz-plot-kinematics-in-three-body-decay"><span class="header-section-number">6.2</span> Dalitz Plot Kinematics in Three-Body Decay</h3>
<p>Let’s consider the three-body decay <span class="math inline">\Lambda_c^+ \to pK^-\pi^+</span> and its kinematics. (see Figure~1) We want to maximize the invariant mass of the proton–Kaon system. (see Figure~6)</p>
<p>There are three outgoing momenta. The idea is that if the three momenta are arranged in opposite directions, the total three-momentum sum should be as small as possible. (see Figure~6)</p>
<p>If we add both momentum vectors, the forward momentum—or more precisely, the magnitude of the sum of the momentum vectors—should be as large as possible. Therefore, we should be on the right side of the Dalitz plot diagram.</p>
<p>Now, consider the mass on the y-axis: should it be as large or as small as possible? (see Figure~3) It should be as small as possible.</p>
<p>Why? Because when the three momenta are collinear and we subtract them appropriately, the invariant mass is minimized.</p>
<p>One way to think about this is to go to the rest frame of the Kaon and pion. If they are flying nearly together, their relative momentum is small. In their mutual rest frame, they could both be at rest, so their invariant mass would simply be the sum of their rest masses—this is the minimum possible.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The minimum invariant mass for any two-particle system is given by <span class="math display">M_{ij}^{\text{min}} = m_i + m_j</span> This occurs when the two particles are at rest relative to each other.</p>
</div>
</div>
</div>
<p>You are correct: we are looking for the minimal invariant mass of the proton–Kaon system.</p>
<p>Let’s identify what this point corresponds to kinematically. In certain configurations, two particles can be nearly at rest while the third carries away the momentum. (see Figure~6) That corresponds to the minimal invariant mass case.</p>
<p>This plot is likely from experimental data. How would we reconstruct such an event experimentally if we don’t detect the proton directly? Even though measurements occur in the lab frame (which is boosted), the analysis is often performed in the center-of-mass frame.</p>
<p>The point of maximum invariant mass occurs when the two particles move back-to-back with maximum momentum. The point we are discussing minimizes the invariant mass.</p>
<p>For three-body decays, there is a similar way to define angular variables. (see Figure~1) Let me briefly mention this.</p>
<p>I will boost into the rest frame for each kinematic setup. To clarify, I am referring to the proton, Kaon, and pion. Suppose I fix the invariant mass of the proton–Kaon system.</p>
<p>The approach is to work in the center-of-momentum frame of the <span class="math inline">\Lambda_c</span>, where the three final-state particles have momenta summing to zero. Then, I boost to the rest frame of the Kaon and pion. (see Figure~6) In that frame, the Kaon and pion have equal and opposite momenta. (see Figure~7)</p>
<p>If I fix the invariant mass of the proton–Kaon system and explore phase space along a line where that mass is fixed, the magnitudes of the momenta are fixed—only the angle <span class="math inline">\theta</span> changes.</p>
<p>As <span class="math inline">\theta</span> varies from <span class="math inline">0</span> to <span class="math inline">\pi</span>, one extreme (<span class="math inline">\theta = 0</span>) corresponds to the proton and Kaon moving in the same direction, yielding a small invariant mass. The other extreme (<span class="math inline">\theta = \pi</span>) corresponds to them moving oppositely, giving the maximum invariant mass.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The invariant mass squared for two particles is <span class="math display">M_{ij}^2 = (p_i + p_j)^2 = (E_i + E_j)^2 - (\vec{p}_i + \vec{p}_j)^2</span> This quantity is Lorentz invariant and is used to define Dalitz plot axes.</p>
</div>
</div>
</div>
<p>For angle <span class="math inline">\theta = 0</span>, the invariant mass is small. As the angle increases, the invariant mass grows. The same logic applies to the other pairings.</p>
<p>A straightforward analysis method is to go to the rest frame of the proton–Kaon system, where all quantities are fixed, and scan by changing the angle between the proton and Kaon relative to the pion direction. (see Figure~6)</p>
<p>Thus, lines in the Dalitz plot represent configurations where the angle is varied in some rest frame.</p>
<p>Another variable in <span class="math inline">2 \to 2</span> scattering kinematics is the <span class="math inline">U</span> variable, which offers a more symmetric treatment. For three-body decays, we also have the invariant mass of the pion–proton system.</p>
<p>If I fix the invariant mass of the proton–Kaon system and scan the angle, which line do I move along? This follows from the relation that the <span class="math inline">U</span> variable is a linear combination of the invariant masses.</p>
<p>In fact, the coefficients are such that the motion corresponds to a diagonal in the Dalitz plot. This line represents a fixed pion–proton invariant mass, moving from one kinematic endpoint to the other.</p>
<p>The standard representation in experimental analyses uses Dalitz plots with the x-axis as the invariant mass squared of one pair and the y-axis as the invariant mass squared of another pair—exactly what is shown here.</p>
<p>In homework, you may encounter a more symmetric Dalitz plot where all variables enter symmetrically. This uses the geometry of an equilateral triangle, where every point inside satisfies a conservation relation.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In the symmetric representation, the coordinates are <span class="math display">x = \frac{\sqrt{3}}{2}(M_{12}^2 - M_{23}^2), \quad y = M_{13}^2 - \frac{1}{2}(M_{12}^2 + M_{23}^2)</span> The factor <span class="math inline">\frac{\sqrt{3}}{2}</span> arises from the 60° angles in an equilateral triangle.</p>
</div>
</div>
</div>
<p>If you sum the perpendicular distances from any interior point to the three sides of an equilateral triangle, the total is constant. This allows us to define symmetric variables representing the sum of the invariant masses.</p>
<p>The variables are interpreted as distances to the sides. This gives a very symmetric and elegant representation.</p>
<p>Essentially, this is equivalent to the standard plot—they are related by a linear transformation, not just a rotation but also a skew. To plot experimental data in this form, one must apply the correct coordinate transformation.</p>
<p>Yesterday, I worked through the algebra relating Cartesian coordinates to the heights in the triangle—it’s straightforward but interesting.</p>
<p>This symmetric representation is nice, while the standard one is more common and easier to plot directly. Both capture the same kinematics.</p>
<p>In the Dalitz plot, regions with higher event density indicate kinematic enhancements. The purpose of this kinematic representation is to identify the dynamics and underlying processes governing the decay.</p>
<div id="fig-fg6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig6.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A kinematic representation of the transition from the initial state to the final state in the process where particle 0 decays into particle x and particle 3. The arrows indicate the three-momenta of particles 3 and x, and the fat dot marks particle 0, which is at rest in this frame.
</figcaption>
</figure>
</div>
<p>Looking ahead, we will see that <span class="math inline">\Lambda_c</span> decay to three particles often proceeds via intermediate resonances. Temporarily, two particles form a resonant state that then decays, increasing the decay rate in certain invariant mass regions.</p>
<p>When the energy of two particles matches a resonance, their interaction is stronger, making the decay more probable. This is why we observe enhanced densities along certain bands in the Dalitz plot.</p>
</section>
<section id="resonance-structures-and-angular-distributions-in-three-body-decays" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="resonance-structures-and-angular-distributions-in-three-body-decays"><span class="header-section-number">6.3</span> Resonance Structures and Angular Distributions in Three-Body Decays</h3>
<p>You might have seen cross sections for two-particle resonances. These exhibit a characteristic bump known as a <strong>hadronic resonance</strong>. The underlying physics is that when you have a system of two particles, and the quantum numbers of that system match those of an intermediate resonance, the interaction probability increases dramatically at specific energies.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>Breit-Wigner resonance cross section</strong> describes this enhancement: <span class="math display">
\sigma(E) \propto \frac{\Gamma^2/4}{(E - E_R)^2 + \Gamma^2/4}
</span> where <span class="math inline">E_R</span> is the resonance energy and <span class="math inline">\Gamma</span> is the resonance width.</p>
</div>
</div>
</div>
<p>By adjusting the system energy, you explore how likely two particles are to interact. When passing through the resonance region, the probability increases significantly. This creates bent structures in the <strong>Dalitz distribution</strong>—when projected onto one axis, you see the characteristic resonance shape.</p>
<p>This example is particularly interesting because it shows <strong>resonances in all three particle pairs</strong>:</p>
<ul>
<li><strong>Horizontal lines</strong> correspond to fixed <span class="math inline">K\pi</span> mass → <span class="math inline">K^*</span> resonances</li>
<li><strong>Vertical lines</strong> correspond to fixed proton-<span class="math inline">K\pi</span> mass → <span class="math inline">K</span>-nucleon resonances</li>
<li><strong>Diagonal lines</strong> correspond to pion-proton combinations → <span class="math inline">\Delta</span> resonances</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>Dalitz plot density</strong> for three-body decays is: <span class="math display">
\frac{d^2\Gamma}{dm_{12}^2  dm_{23}^2} = \text{constant} \times |\mathcal{M}|^2
</span> where <span class="math inline">m_{ij}</span> are invariant masses and <span class="math inline">\mathcal{M}</span> is the decay amplitude. (see Figure~1)</p>
</div>
</div>
</div>
<p>The lines appear parallel to the sides of the Dalitz triangle:</p>
<ul>
<li><span class="math inline">K^*</span> resonances parallel to one side</li>
<li><span class="math inline">\Lambda</span> resonances parallel to another side</li>
<li><span class="math inline">\Delta</span> resonances parallel to the third side</li>
</ul>
<div id="fig-fg3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig3.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Dalitz plot, a representation of the phase-space for the three-body decay. (see Figure~6) It appears as an ellipse-shaped area where the internal region corresponds to allowed kinematics and the outside region is forbidden. On the x-axis lies the squared mass of two final-state particles, while the y-axis corresponds to the other subsystem. A horizontal line represents a slice of the phase-space with one mass fixed. The borders of the area correspond to configurations where all three momenta are aligned in the rest frame of the decaying particle, or equivalently, where the scattering angle in the relevant rest frame is either 0 or π.
</figcaption>
</figure>
</div>
<p>Now let’s examine <strong>angular distributions within resonance bands</strong>. When traversing phase space while keeping the mass combination fixed, you’re effectively changing the decay angle. This angle dependence reveals important physics:</p>
<ul>
<li>Within a resonance band, probability can be <strong>inhomogeneous</strong></li>
<li>Particles often prefer aligned vs.&nbsp;perpendicular configurations</li>
<li>These preferences occur because <strong>intermediate resonances have spin</strong></li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Angular distributions are powerful tools for measuring:</p>
<ul>
<li><strong>Spin</strong></li>
<li><strong>Parity</strong></li>
<li><strong>Other quantum numbers</strong></li>
</ul>
</div>
</div>
</div>
<p><strong>Key observations:</strong></p>
<ul>
<li>Higher spin particles produce more structured angular distributions</li>
<li>Scalar particles produce no angular asymmetries</li>
<li>The number of nodes in angular distribution often equals the spin value</li>
<li>For spin-<span class="math inline">J</span> particles: <span class="math inline">N_{\text{states}} = 2J + 1</span> spin projections</li>
</ul>
<p>When dealing with particle spins, we need to understand how quantum states transform under rotations. For a particle with spin <span class="math inline">J</span>, there are <span class="math inline">2J+1</span> possible projections along a quantization axis.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>Wigner D-function</strong> describes rotations using Euler angles <span class="math inline">(\phi, \theta, \gamma)</span>: <span class="math display">
D^J_{m'm}(\phi, \theta, \gamma) = e^{-i m' \phi}  d^J_{m'm}(\theta)  e^{-i m \gamma}
</span> where <span class="math inline">d^J_{m'm}(\theta)</span> is the Wigner small d-matrix.</p>
</div>
</div>
</div>
<p><strong>Rotation conventions in particle physics:</strong> 1.</p>
<div id="fig-fg4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig4.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: A diagram showing the spin projection. The horizontal line arrow indicates the z-axis, which is chosen as the quantization axis. The arrow denotes the particle spin, and its projection onto the axis is represented by m in the equations.
</figcaption>
</figure>
</div>
<p>Rotate by <span class="math inline">\phi</span> about Z-axis</p>
<ol start="2" type="1">
<li>Rotate by <span class="math inline">\theta</span> about Y-axis</li>
<li>Rotate by <span class="math inline">\gamma</span> about Z-axis again</li>
</ol>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Be careful with conventions!</strong> Mathematica uses opposite sign conventions compared to standard particle physics. Wikipedia and Python’s sympy library are reliable references.</p>
</div>
</div>
</div>
<p>Let’s construct a model for three-body decays via cascade processes: initial particle → intermediate resonance <span class="math inline">X</span> → particles 1 + 2, plus particle 3.</p>
<p>![A unitary diagram for the three-body decay.</p>
<div id="fig-fg5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig5.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: A dynamic diagram of a cascade decay, where particle 0 decays to a three-body final state through an intermediate state x that sequentially decays into particles 1 and 2. (see Figure~6) The intermediate particle carries spin j and serves as an expansion term of the full amplitude, known as the partial projection term. Lines represent initial and final state particles, while the double line denotes the intermediate particle.
</figcaption>
</figure>
</div>
<p>The arrows show the initial and final state particles, and the blob stands for the interaction that transforms the initial state into the final state.](2024-Lecture-05-images/fig1.png)</p>
<p>The general <strong>cascade decay amplitude</strong> structure:</p>
<p><span class="math display">
A_{\lambda_0, \lambda_1, \lambda_2, \lambda_3}(s, \theta) = \sum_{\lambda'_X} H^X_{\lambda_0 \lambda'_X} D^{j_X}_{\lambda'_X \lambda_X}(\theta_X, \phi_X) H^Y_{\lambda_X \lambda_Y} D^{j_Y}_{\lambda_Y \lambda_3}(\theta_Y, \phi_Y)
</span></p>
<p><strong>Component breakdown:</strong></p>
<ul>
<li><strong><span class="math inline">H</span> factors</strong>: Contain dynamics from strong/weak/EM interactions</li>
<li><strong><span class="math inline">D</span> functions</strong>: Handle rotational kinematics and angular distributions</li>
<li><strong><span class="math inline">\lambda_i</span></strong>: Helicity projections along particle directions of motion</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In the <strong>helicity formalism</strong>, we quantize spins along the direction of motion, making <span class="math inline">\lambda_i</span> the helicity projections.</p>
</div>
</div>
</div>
<p><strong>Special case: aligned kinematics</strong> (<span class="math inline">\Phi = \theta = 0</span>)</p>
<ul>
<li>Rotation matrices simplify significantly</li>
<li>Many summations collapse due to delta functions</li>
<li>Final expression becomes much cleaner:</li>
</ul>
<p>The simplified amplitude becomes: <span class="math display">
\mathcal{A} = H_0 D(\theta)^{J_X}_{\lambda_X, \lambda_0 + \lambda_3} D(\theta)^{\lambda_0 + \lambda_3}_{\lambda_1 - \lambda_2}
</span></p>
<p><strong>Key insight</strong>: Angular distributions are determined primarily by <strong>rotational group properties</strong>, with only the production preferences coming from specific interactions.</p>
<div id="fig-fg7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-05-images/fig7.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: A kinematic configuration for the introduction of the helicity matrix in the transition of particle x decaying into particles 1 and 2. The representation is drawn in the rest frame of particle x, shown as a dot at rest, with arrows representing the three-momenta of particles 1 and 2 in this frame.
</figcaption>
</figure>
</div>
<p>This separation makes angular analysis a powerful model-independent tool for determining particle properties.</p>
</section>
<section id="angular-distributions-and-partial-wave-analysis" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="angular-distributions-and-partial-wave-analysis"><span class="header-section-number">6.4</span> Angular Distributions and Partial Wave Analysis</h3>
<p>How many numbers do I need in order to compute electromagnetic interactions or gravity? Specifically, to predict the angular distribution, what input parameters are required? The current framework appears to miss some fundamental components.</p>
<p>What is inside these interaction vertices or amplitude blocks? To predict all observable values, I need the transition amplitudes for different spin configurations.</p>
<p>The number of independent amplitudes is given by the spin degeneracy factor: <span class="math display">(2j_1 + 1)(2j_2 + 1)</span> where <span class="math inline">j_1</span> and <span class="math inline">j_2</span> are the spins of the particles involved. These amplitude values might also be functions of particle masses, particularly the masses of the intermediate states.</p>
<p>A similar number of parameters is needed for the final state amplitudes, but there are reasonable approximation methods available.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In experimental analysis, we often make the initial assumption that these amplitude coefficients are constant, representing fundamental particle properties rather than dynamic functions. This simplification allows us to compute angular distributions without knowing the detailed internal dynamics.</p>
</div>
</div>
</div>
<p>With this constant amplitude assumption, I can compute the angular distribution while fixing the mass parameters and intensity normalization.</p>
<p>The differential decay rate with respect to <span class="math inline">\cos\theta</span> is given by: <span class="math display">\frac{d\Gamma}{d\cos\theta} \propto |\mathcal{M}|^2</span></p>
<p>Using <span class="math inline">\cos\theta</span> rather than <span class="math inline">\theta</span> itself is preferable because it has a simpler Jacobian—we avoid the <span class="math inline">\sin\theta</span> factor that appears in the <span class="math inline">\theta</span> distribution. The matrix element squared <span class="math inline">|\mathcal{M}|^2</span> is typically treated as constant in this approximation.</p>
<p>The angular distribution spans from <span class="math inline">\cos\theta = -1</span> to <span class="math inline">\cos\theta = 1</span>:</p>
<ul>
<li>A flat distribution indicates isotropic decay</li>
<li>For particles with spin, we often observe parabolic distributions (second-order polynomials in <span class="math inline">\cos\theta</span>)</li>
<li>Other characteristic patterns may appear depending on the spin structure</li>
</ul>
<p>It’s crucial to recognize that <span class="math inline">A</span> represents the quantum transition amplitude—a complex-valued quantity that gets squared to give the observed probability. In experiments, we only measure the squared magnitude of amplitudes.</p>
<p>For unpolarized decays, the distributions are averaged over initial spin projections and summed over final spin projections: <span class="math display">\frac{d\sigma}{d\Omega} \propto \frac{1}{(2s_1+1)(2s_2+1)} \sum_{\text{spins}} |\mathcal{M}|^2</span></p>
<p>When analyzing experimental data, we don’t initially guess the amplitude form directly. Instead, we project the angular distributions onto orthogonal polynomials, particularly Legendre polynomials: <span class="math display">\frac{d\sigma}{d\cos\theta} = \sum_{\ell=0}^{L_{\text{max}}} a_\ell P_\ell(\cos\theta)</span></p>
<p>This Legendre polynomial basis connects directly to the spins of the produced particles, forming the foundation of:</p>
<ul>
<li><strong>Partial wave analysis</strong>: Modeling cross sections with amplitude parameters to learn about internal dynamics</li>
<li><strong>Moment analysis</strong>: Projecting differential cross sections onto polynomial moments</li>
</ul>
<p>The initial projection onto polynomials doesn’t directly reveal the internal amplitude structure but provides combinations of these parameters that can be measured experimentally.</p>
<p>This approach isn’t straightforward, and we’ll have more opportunities to discuss it in detail. We’ve only briefly touched on the differences between canonical states (defined in the rest frame) and helicity states introduced later.</p>
<p>For comprehensive coverage of this subject, I recommend Martin Spearman’s <em>Elementary Particle Theory</em>, particularly Chapter 4, which covers:</p>
<ul>
<li>Lorentz group fundamentals</li>
<li>Vector construction methods</li>
<li>Accessible group theory applications</li>
<li>Particle state definitions</li>
</ul>
<p>The chapter provides substantial insights without overwhelming mathematical complexity.</p>
<p><strong>Exercise Assignment</strong>: I will distribute Dalitz plots from CLEO and BaBar experiments with removed particle labels. You’ll receive:</p>
<ul>
<li><p>One <span class="math inline">D</span> meson decay dataset</p></li>
<li><p>One <span class="math inline">D_s</span> meson decay dataset Using your kinematic knowledge, your task is to:</p></li>
<li><p>Determine particle masses from the kinematic boundaries</p></li>
<li><p>Identify the specific decay processes Each group will analyze one case initially, then examine additional examples.</p></li>
</ul>
</section>
<section id="office-hours-arrangement" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="office-hours-arrangement"><span class="header-section-number">6.5</span> Office Hours Arrangement</h3>
<hr>
<p><strong>People, I have to leave now.</strong></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This portion of the lecture contains only administrative announcements about homework distribution and scheduling—<strong>no physics formulas or technical content</strong> are present in this segment.</p>
</div>
</div>
</div>
<p><strong>Homework Distribution:</strong></p>
<ul>
<li>If you don’t want to take the homework now, I’ll distribute it from my office.</li>
<li>Please come with me to collect it.</li>
<li>This applies to all of you.</li>
</ul>
<p><strong>Schedule &amp; Apologies:</strong></p>
<ul>
<li>Thank you for coming, and I apologize for being slightly late.</li>
<li>Will you have time tomorrow at <strong>8am</strong>?</li>
<li>You may leave now.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>