<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2024-01-01">

<title>(2024) Lecture 12</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-597958c53c93a607afca12fd375c57ed.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d3a565c23c4d3b0e7c030e96a8964f3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pion-decay-muon-polarization-and-the-anomalous-magnetic-moment" id="toc-pion-decay-muon-polarization-and-the-anomalous-magnetic-moment" class="nav-link active" data-scroll-target="#pion-decay-muon-polarization-and-the-anomalous-magnetic-moment"><span class="header-section-number">1</span> Pion Decay, Muon Polarization, and the Anomalous Magnetic Moment</a></li>
  <li><a href="#dispersion-relations-and-analytic-continuation" id="toc-dispersion-relations-and-analytic-continuation" class="nav-link" data-scroll-target="#dispersion-relations-and-analytic-continuation"><span class="header-section-number">2</span> Dispersion Relations and Analytic Continuation</a></li>
  <li><a href="#hadronic-contributions-and-the-muon-anomaly" id="toc-hadronic-contributions-and-the-muon-anomaly" class="nav-link" data-scroll-target="#hadronic-contributions-and-the-muon-anomaly"><span class="header-section-number">3</span> Hadronic Contributions and the Muon Anomaly</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(2024) Lecture 12</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Presenter</strong>: Mikhail Mikhasenko</p>
<p><strong>Note Taker</strong>: Ilya Segal</p>
<section id="pion-decay-muon-polarization-and-the-anomalous-magnetic-moment" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="pion-decay-muon-polarization-and-the-anomalous-magnetic-moment"><span class="header-section-number">1</span> Pion Decay, Muon Polarization, and the Anomalous Magnetic Moment</h2>
<p>We are finishing the lecture cycle. Two more to go. Today is the month before last. However, content-wise, today will be more on physics, and next week I would like to discuss sort of meta issues and how the hadron community functions. I will give you a little bit of background on how research is structured in the field, how collaborations work, and what are aesthetical issues—or not aesthetical, but what are actually how scientists work in the hadron physics domain. And there will be less on physics. Perhaps I will spend the first 20 minutes next time also reviewing the recent discoveries and what experiments brought up and what the hadron community is currently up to.</p>
<p>But today I would like to talk a bit more in physics and have still to write formulas and discuss how hadronic physics is used outside of hadronic physics. How this is an important part of many other studies. And I’ve been deciding on just one lecture that I would like to dedicate to deciding between CP violation, where hadronic physics is an important part through which CP violation shows up. Another part is the… Another subject I was considering is the <span class="math inline">g-2</span> and hadronic contributions to the magnetic moment of the muon. And that’s what we will discuss. So I decided on that rather fundamental piece, and it touches a couple of subjects that we’ve discussed already. The exercise sheet actually is on the <span class="math inline">R</span> ratio, something I thought of giving, and we decided to postpone. And now we enhance this with more problems that you know now. And we’ll discuss this on a kind of more advanced level, giving all the knowledge that we have. But I would like to start today’s lecture with a short recap, and that will help us to get started. Something I would like to go back to is our discussion of the helicity and chirality and discuss the pion decay. <span class="math inline">\pi^+</span> goes to <span class="math inline">\mu^+ \nu_\mu</span> , and I would like you to look and compare. So I would like to look at this decay and start with that, and I will give you two minutes to set your mind and to understand what it is about. So start by drawing this two-body decay in the rest frame of the decaying particle, indicate momenta, and indicate chirality. So the vertex that is here, and I find the case is actually weak interaction. So therefore, particles that are produced are produced with their chiral properties. So they are left or right. Therefore, on this diagram we will clearly see, since chirality is related to the spin orientation in the limit of high energy, we will see clearly the chirality, and then I’ll just give you a guess. Given these chiral configurations, what are the ratios of the matrix element for the first and second? And then give you a guess for it. This is rather straightforward. Just tell which phase space is bigger for the first or second. And then, of course, the natural question you want to go to is which of these two is more likely for the pion to decay. Let’s do three minutes.</p>
<div id="fig-fg1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This figure schematically represents the kinematics and spin-chirality structure of the two-body pion decay <span class="math inline">\pi^+ \to \mu^+ \nu_\mu</span> in the rest frame of the pion. The arrows indicate the directions of momenta and spin of the decay products (muon and neutrino), and the labels “LH” (left-handed) and “RH” (right-handed) denote the chirality of the outgoing particles. - The <strong>top diagram</strong> shows a configuration where both the muon and neutrino have their spins aligned, resulting in a total spin projection that is forbidden for the decay of a spin-0 pion ( <span class="math inline">J^\pi = 0</span> ). This is because the weak interaction produces neutrinos with fixed left-handed chirality and muons that, unless mass corrections are included, are also overwhelmingly left-handed. The configuration where both spins point in the same direction is not possible due to angular momentum conservation. - The <strong>bottom diagram</strong> shows the allowed configuration, where the spins are anti-aligned. This state is allowed but suppressed by a factor of <span class="math inline">m/E</span> (the ratio of the muon’s mass to its energy), since the muon’s right-handed component is suppressed compared to the left-handed component by its (small, but nonzero) mass. Physically, this illustrates why the pion decays preferentially to muons: the chirality structure of the weak vertex (the <span class="math inline">V-A</span> interaction) only allows certain helicity combinations, and configurations not matching the required angular momentum of the pion are either forbidden or heavily suppressed. The suppression for the electron channel is even stronger due to the much smaller electron mass, leading to the observed dominance of <span class="math inline">\pi^+ \to \mu^+ \nu_\mu</span> over <span class="math inline">\pi^+ \to e^+ \nu_e</span> .
</figcaption>
</figure>
</div>
<p>So draw the center-of-momentum decay kinematics, indicate chirality. I should note here: neutrino, not antineutrino. Because electron comes with antineutrino. And then indicate chirality. So we discussed that the weak interaction vertex comes with a <span class="math inline">V-A</span> , which means <span class="math inline">\gamma^\mu (1 - \gamma^5)</span> . And it produces a projector that acts on the current. For example, if you have a <span class="math inline">\bar{u} \gamma^\mu u</span> , and this <span class="math inline">\gamma^\mu</span> has <span class="math inline">1 - \gamma^5</span> , it makes your quark on the left left and then on the right right, as we want. One makes this guy left, this guy right. So then in this case, this vertex, since it’s a <span class="math inline">W</span> boson essentially here that produces these two, it produces them in their chiral configuration. So electron is going to be right? Sorry, positron is going to be right. So electron will be left and then neutrino will be left. So for the right electron, most likely, or it has two components in its spinor, and the left component is suppressed with the mass. And antineutrino, or so neutrino is the particle, and it’s in its chiral configuration that spin is—I mean, the mass of neutrino is zero. Therefore, it’s actually purely left-handed particle. So the helicity is fixed. So for the right-handed particle, the spin component that has a spin aligned with momentum is dominant. For the left-handed particle, this is dominant. And then we do the same for the other. And now we see this. For both of these particles, the spins are equal to <span class="math inline">1/2</span> , the spin projection <span class="math inline">1/2</span> . Therefore, they go back-to-back in the rest frame, in the center-of-momentum frame. The total spin sum is one, which cannot be because of the pion spin. So this is forbidden by the spin of the pion, as well as this. But then other configurations: so actually, what we can do is we can flip the spin of the right-handed particle, so this one would be allowed but suppressed by—so neutrino we cannot do much. This is neutrino. Neutrino with zero mass does not have an opposite component, but electron does. So <span class="math inline">V_R^+</span> , and this is suppressed. There is a term of mass over energy suppressed. And actually, that leads us to the second question. So the matrix element for the electron and for the muon are suppressed slightly differently because muon mass and electron mass are different. So the lighter the particle is, the bigger the suppression? For the electron it will be tiny. And for the muon, especially, so the muon in the decay of the pion is non-relativistic because the pion mass is not much bigger than muon mass. Therefore, in that decay, the chirality state of the particle does not really imply—I mean, this suppression is not that strong. So therefore, the right answer here is—what’s the right answer? Then, more or less, is the ratio more than one or less than one? The ratio is significantly less than one. And that actually determines the fact that pion decays predominantly to muon and neutrino, not electron and neutrino.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Physics of Pion Decay:</strong> The matrix element for the decay <span class="math inline">\pi^+ \to \ell^+ \nu_\ell</span> is proportional to the lepton mass <span class="math inline">m_\ell</span> due to the <span class="math inline">V-A</span> weak interaction structure. This explains the dominance of the muonic decay over the electronic one, despite the larger phase space for electrons. <span class="math display">\frac{|\mathcal{M}_{e}|^{2}}{|\mathcal{M}_{\mu}|^{2}} \ll 1, \qquad \frac{m_{e}}{E} &lt; \frac{m_{\mu}}{E}</span></p>
</div>
</div>
</div>
<p>And for the phase space, it’s easy to see the phase space is actually the number of configurations. In that case, for the two-body decays, it’s just angular configuration. They are the same, but that is also energy-dependent factor, giving you how much of the energy release you have in the decay. So that’s what phase space is. The bigger the release of energy, the bigger the phase space. And then for muon, so you think of the initial state as the system with a certain energy given by the mass of the pion. And then the final state has the particles that themselves carry some masses. And the release of the energy essentially is the difference of the masses. And for the first case, the release is tiny because the mass difference is small. And the second case, all energy goes to the kinetic energy. Because neutrino is massless, electron is almost massless, so the phase space is much bigger. For the second case, however, this does not compensate the suppression.</p>
<p>Let’s go to the calculation. For the calculation, the phase space of electron and neutrino over the phase space of muon and neutrino, something like that. So the breakup momentum is something I need to evaluate. And I will double-check what I do if particles have mass. How to do this easily, I think it’s right. But I want to explain to you, you already know this. So this would be a function of <span class="math inline">s</span> , mass of pion squared, and would be another function of <span class="math inline">s</span> , mass of muon squared. And then the function is <span class="math inline">x, y, z</span> . So it would be <span class="math inline">x^2 + y^2 + z^2 - 2xy - 2yz - 2zx</span> . And once I drop the terms, <span class="math inline">x^2 + y^2 + z^2 + 2xy - 2yz - 2zx</span> . And then <span class="math inline">b = 0</span> , this term is dropped. So the further is just the difference. It’s just the full square, which I then put in: <span class="math inline">(s - m_e^2) / (s - m_\mu^2)</span> .</p>
<div id="fig-fg2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: This figure expresses the suppression of the matrix element for the decay of a pion into an electron and a neutrino ( <span class="math inline">\pi^+ \to e^+ \nu_e</span> ) relative to the decay into a muon and neutrino ( <span class="math inline">\pi^+ \to \mu^+ \nu_\mu</span> ). The key point made in the lecture is that, due to the <span class="math inline">V-A</span> structure of the weak interaction, the decay probability is proportional to the lepton mass over the available energy ( <span class="math inline">m_\ell/E</span> ). Since the electron mass is much less than the muon mass, <span class="math inline">m_e/E &lt; m_\mu/E</span> , which leads to a strong suppression of the electronic channel. The image summarizes this by showing that the squared matrix element ratio <span class="math inline">|\mathcal{M}_e|^2 / |\mathcal{M}_\mu|^2</span> is much less than 1. This is a crucial physical factor explaining why <span class="math inline">\pi^+</span> decays predominantly to muon and neutrino, not electron and neutrino, despite the larger phase space for electrons.
</figcaption>
</figure>
</div>
<p>Sorry, <span class="math inline">s - m_\pi^2</span> . So this full, full, full square is dropped because of the <span class="math inline">1/2</span> . And this is the answer. So this factor does not compensate the suppression.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Phase Space Ratio:</strong> The standard two-body phase space factor in the center-of-mass frame is <span class="math inline">\Phi = \frac{1}{8\pi} \frac{2p}{\sqrt{s}}</span> , where <span class="math inline">p</span> is the breakup momentum. For pion decay, the ratio of phase spaces favors the electronic channel, but this is overwhelmed by the matrix element suppression. <span class="math display">\frac{\Phi(e^{+}\nu_{e})}{\Phi(\mu^{+}\nu_{\mu})} = \frac{\lambda^{1/2}(s,m_{e}^{2},0)}{\lambda^{1/2}(s,m_{\mu}^{2},0)} = \frac{s-m_{e}^{2}}{s-m_{\mu}^{2}} &gt; 1</span></p>
</div>
</div>
</div>
<p>So the dominant decay of the pion is to muon neutrino. And I think that’s… I mean it’s really important to realize what the steps we’ve done. Because this is a nice piece of physics. It’s how the parity violation was discovered. By seeing that the first muon is the predominant decay. For that you need for this vertex to be <span class="math inline">V-A</span> weak interaction. And the second is another interesting fact that in this decay, in this decay the muon is produced polarized. So the pion doesn’t carry a spin. It decays to a neutrino. The neutrino you don’t register, it just flies away. And then the muon is produced polarized. So in 1967, the experiment was right. So what’s cool about the muon is that it’s actually self-analyzing. It has a self-analyzing decay. So the muon goes to electron neutrino, anti-neutrino. And the angular distributions of the electrons indicate the polarization of the muon. So it’s actually a super nice setup. You want to analyze either vertex that is here has sort of <span class="math inline">V-A</span> current that violates parity. So this term, this gamma axial term would violate parity. So just keep this violates parity. And you can check easily by looking and then goes to the electron. Because the second decay, the weak muon decay has a charged track. And the angular distribution of this charged track in the rest frame of the muon would tell you whether the muon is polarized or not. So if it’s not polarized, you have in the rest, in the helicity frame of the muon you have all directions of the part of the electron equal, equally probable. But if it is polarized, the forward direction is preferred, forward with respect to the spin. So it’s aligned with the spin aligned around. So it’s actually either aligned or anti-aligned with the spin of the muon. So the muon flies. The muon flies. It carries the spin. And then in the rest frame of the… you’re sitting in the rest frame and you only have the spin information. So they measure the… This is called the CM frame that we discussed. And then in this frame the electron preferably goes. This is the preferred configuration. Well, of course the electron can go in any direction, it’s just the probability is different. And if you integrate over the true energies, you find out that this is the preferred configuration even for the linearly polarized muon beam.</p>
<p>And then shortly after, the same technique was used to measure something more fundamental, namely the magnetic moment of the muon. So this we touched on in the second lecture, when we discussed the quark content of the proton. We calculated, using the quark content of the proton, to calculate the magnetic moment. Let me remind you what it is. The magnetic moment of a particle gives the interaction of this particle with a magnetic field. And for a point-like fermion, it’s given by the Bohr magneton and the gyromagnetic factor. And this is usually called <span class="math inline">g</span> . So this is a fundamental quantity that is <span class="math inline">g = 2</span> for a fermion. And we found out that for the proton, actually this is 2.8. Then something is wrong. Although a fermion is… Sorry, the proton is a fermion. And why this <span class="math inline">g</span> is not? And this indicated that it’s not. So out of these two words, “fermion” and “point-like,” the first one is not valid for the proton. So it’s actually made of quarks. And then we computed that the value you get, the right value in the quark model, and part of it comes from the charge. So this <span class="math inline">Q</span> , this <span class="math inline">e</span> in the numerator is the charge of the particle. For the proton it’s plus one. But for quarks it would be fractional charge. And then the mass. We have to put the mass of the quarks to be like constituent quark model masses, like 0.3 for <span class="math inline">u</span> and <span class="math inline">d</span> quarks. And then by doing this we found out that what is measured in experiment for the proton is actually the same. You roughly understand this in terms of the constituent correlation. But this exercise was done for the muon. The muon. We don’t doubt that the muon is an elementary particle. It doesn’t have internal structure. So for the muon you expect this <span class="math inline">g</span> to be 2, but it turns out that this is only to first order. So there are corrections to this from all different types of virtual processes that make this <span class="math inline">g</span> not exactly 2. But the number that I use. So <span class="math inline">g</span> is a constant. It’s one of the numbers that we know. I mean, it’s one of the most precisely known numbers, <span class="math inline">\pi/2</span> . Well, the way how it’s usually given is <span class="math inline">g/2</span> . So the <span class="math inline">g</span> for muon is <span class="math inline">g</span> , and then… And then it’s common language to introduce the quantity <span class="math inline">a</span> , which are corrections to the <span class="math inline">g</span> , and give it as the <span class="math inline">g-2</span> divided by 2. I think we know, I mean there are a few numbers in mathematics that we know more digits. But in physics such a precision does not come very often. And there is a huge effort on measuring even more digits. Because that gives us sensitivity to loop effects and to new physics, because the corrections come from quantum processes. It’s similar to the form factor of the proton that we discussed. This <span class="math inline">g</span> characterizes the interaction of the photon with the muon. So we probe this particle with a source of photons. And <span class="math inline">g</span> tells us how it sees. How the light sees the particle. If it were composite, then we would resolve the individual components. But here, in the case of muon, leading corrections to the vertex, such a function comes from this. From this cool process that we draw. It was first calculated. Feynman should be the one who realized that such processes in QED impact the magnetic moment. QED is a theory that we can calculate in perturbation theory. And the series converges; you calculate more and more loops. So now you can start including morphologies. These processes, these three, these four, crossing. Introducing the coils here, all of the possible processes are calculated to a fixed order. So count vertices here. 1, 2. So this gives you the first order. This is the charge of the electron. This is the charge of the muon. The product is <span class="math inline">\alpha</span> . So <span class="math inline">e^2 / 4\pi</span> is <span class="math inline">\alpha</span> . And that’s what here. So it’s the electron mass squared that comes from these vertices. And now we know the corrections up to the fifth order. So we know <span class="math inline">\alpha^2, \alpha^3, \alpha^4</span> and so on, up to 5. And this <span class="math inline">\alpha^5</span> correction is equal to something, <span class="math inline">\alpha</span> , 25 <span class="math inline">\alpha</span> . Let me see if I have a number. But it’s not that important to have it exactly. 17. So the number in parenthesis is always indicating the uncertainty, whatever last digits you have. So here. And actually I’m now curious. So the number is pretty big. I’m curious to compare this to the fourth order which is also… No, it’s 130. So it’s probably comparable. But anyway, so the series is converging. And now we have numerical technologies. No one can create these diagrams any longer by hand, as Schwinger did. So you set the computer. There are probably millions of terms in the fifth order that you have to all evaluate, and all loop integrals are related. Fortunately, I think you might neglect the mass of the muon later. So I don’t know exactly for the higher orders how calculations are done. The curious fact probably on the first order. So this happened around the 1970s. And then Schwinger has this <span class="math inline">\alpha / 2\pi</span> pioneer, his great contribution. And then I don’t know who decided, probably Feynman. So it’s written <span class="math inline">\alpha / 2\pi</span> . Schwinger did he calculate the diagrams? Yeah, well, techniques that have been at that time, I’m not sure that were Feynman diagrams. But starting from the QED Lagrangian you evaluate this process. That’s. I wrote it down here. It’s experimental, <span class="math inline">g-2</span> . And the way how we know it is actually quite nice and neat experimental setup. Using the <span class="math inline">\pi</span> decay to muon and muon going to electron and two neutrinos. So using the same setup that was proposed 50 years ago. So we have a ring in which muons. So a bunch of muons is trapped. There is a magnetic field. And then once there is a magnetic field, the charged particle moves with the momentum that the bending force acts on the particle. That’s why the muon is traveling around on the circle. So that muon goes on like a regular collider. So the setup, just for your imagination, the setup is like three of these rooms. It’s 20 meters radius. And this experiment has been done before. And the recent one is at BNL, Brookhaven National Lab. But what happens also in a magnetic field is that the spin starts precessing. So I have in mind this picture. So there is a… And there is a cone. There is a spin. And then it’s actually rotating around, precessing. And there are frequencies. It. I’m not too sure about this minus sign; it doesn’t look right to me because <span class="math inline">\gamma</span> is more than one. So this term gets crudely negative with the mass of equinox. So I’ll double check. I have five minus. I have in the notes you here somewhere? No, probably not. Or maybe I do. So before using this and setting up your existence experiment, double check the minus sign. And that’s. And the cool part, and actually the critical part, is that <span class="math inline">\omega_c - \omega_s</span> is proportional to this <span class="math inline">a</span> function. So it’s the <span class="math inline">g-2</span> over 10 D over. So the difference of the frequencies comes really proportional to these corrections to the chip. So it means that actually if you start here with this configuration and make one circle so that it comes to the same point slightly shifted, slightly tilted, and this tilting is actually proportional to the <span class="math inline">a</span> .</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Anomalous Magnetic Moment:</strong> The anomalous magnetic moment <span class="math inline">a_\mu</span> is defined as the deviation of the gyromagnetic ratio <span class="math inline">g</span> from the Dirac value of 2. It is one of the most precisely measured quantities in physics. <span class="math display">a_{\mu} \equiv \frac{g-2}{2} = 0.001165\,8209(63)</span><br>
The leading quantum electrodynamics (QED) correction was calculated by Julian Schwinger: <span class="math display">a_{\mu}^{\text{QED}} = \frac{\alpha}{2\pi}</span></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Spin Precession in the <span class="math inline">g-2</span> Experiment:</strong> In a uniform magnetic field <span class="math inline">\mathbf{B}</span> , the difference between the cyclotron frequency <span class="math inline">\omega_c</span> and the spin precession frequency <span class="math inline">\omega_s</span> for a muon is directly proportional to <span class="math inline">a_\mu</span> . <span class="math display">\omega_a = \omega_s - \omega_c = a_\mu \frac{eB}{m_\mu}</span><br>
This “beat frequency” <span class="math inline">\omega_a</span> is the observable measured in storage ring experiments.</p>
</div>
</div>
</div>
<p>The experiment then is as follows. You come with the proton beam—that’s a hydrogen beam, the easiest beam we can get. You hit the target and you get a bunch of pions flying forward. You collect the pions and you direct them towards your ring. So here is the tunnel through which the pions from the secondary vertex come. And in this tunnel they decay. And some of the pions get converted to muons and muons are trapped. Then in the ring they start. Since the pion produces muons polarized, they already have exactly the same, exactly the configuration that we want.</p>
<div id="fig-fg4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig4.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: This diagram illustrates the setup and principle of the <span class="math inline">g-2</span> measurement experiment for the muon. The image shows a storage ring (large circle) with a uniform magnetic field <span class="math inline">\vec{B}</span> perpendicular to the plane of the ring. Muons ( <span class="math inline">\mu^+</span> ) are injected and travel in circular orbits due to the Lorentz force from the magnetic field. The key physical aspect depicted is the precession of the muon spin <span class="math inline">\vec{S}</span> as the muon circulates in the ring. As a result of the anomalous magnetic moment ( <span class="math inline">a_\mu \equiv (g-2)/2</span> ), the spin precesses relative to the momentum <span class="math inline">\vec{p}</span> with an angular frequency <span class="math inline">\omega_a</span> , which is proportional to <span class="math inline">a_\mu</span> . This precession is the observable effect measured experimentally: by detecting the angle between <span class="math inline">\vec{S}</span> and <span class="math inline">\vec{p}</span> over time (typically via the angular distribution of decay electrons), experimentalists extract the value of the muon’s anomalous magnetic moment. The diagram encapsulates the relationship between the muon’s motion, its spin precession, and the external magnetic field in the <span class="math inline">g-2</span> experiment context, as discussed in the lecture.
</figcaption>
</figure>
</div>
<p>There is a muon, there is a spin. And by applying a magnetic field, this setup starts working. So the muon moving along the circle, the spin starts precessing. And the way how we measure the spin orientation is actually by looking at the electron. So muons going along the circle decay. It’s a bunch of particles, <span class="math inline">10^7</span> particles or I don’t know exactly, but let’s say millions of particles in the bunch, and then they move and some of the muons decay. And then by looking at this decay… So inside of the circle here there are calorimeters and I think it’s lead glass calorimeters. It’s a big block—the regular material that we use also in COMPASS and not in LUCID, but used to be in several experiments. So this is a typical setup using lead glass. That’s a material, it’s a glass doped with lead, such that the <span class="math inline">Z</span> of the material is higher. And once a particle comes in, it doesn’t leave, it just leaves all energy inside. But since it’s a glass, it’s transparent for the light. Therefore you just put this heavy block of glass and then a photosensor at the end. And then a particle comes in, leaves energy, and the sensor collects this energy. So these are a type of calorimeter. And these calorimeters measure the flux of electrons that come in. So if the spin points outwards, you have a loss of electrons. If the spin points inwards, you have more electrons. So along the circle you see fluctuations of the energy deposit. And that’s what—what if you hear the talk about <span class="math inline">g-2</span> measurements—the digital plot that you see is time on the x-axis and then energy deposit, or it’s not energy deposit that’s shown, but… oh, something that’s… And then people just cut this piece and start over.</p>
<p>The frequency of rotation stays the same. So let me just be more consistent. So frequency doesn’t change. It is determined by the charge of the electron. So what happens is that out of these muons in the batch, some of them decay. Therefore the overall energy that’s deposited decreases, decreases exponentially. But then it’s modulated by this spin rotation, fluctuating up and down. And then you collect these statistics for three years and then you have the number.</p>
<p>The analysis is blinded. So last year or two years ago, there was a big press release of the new measurements of <span class="math inline">g-2</span> . Apparently before setting up the data and starting the analysis, the analysts wrote down on a piece of paper in an envelope the real frequency that had been used. And then at the press conference, the analysis was unblinded. So they took the envelope, opened it, typed in the real frequency, pressed the button in the map to flip the plot, and showed the numbers that had been measured.</p>
<p>So you’re measuring <span class="math inline">\omega_s</span> and you… Oh no, it’s actually right. You… What enters the… What enters the fit is really this variable. So the fact that we can measure… So let me see. Just a sec.&nbsp;I see what you mean. So are these fluctuations related to <span class="math inline">\omega_c</span> or not? Yeah, as far as you explain… You would like to measure <span class="math inline">\omega_s</span> and then just plot down as many data points as you can. So this… Look, if the two velocities were exactly the same, the spin configurations would just propagate the same way. So nothing would change. Therefore, up and down fluctuations… No, no, no. This is <span class="math inline">\omega_c</span> . So I wanted to make a point that it’s a ratio, it’s a difference that enters. And this plot is sensitive to the difference. But I don’t see it now. So just looking at the way we discuss it now, I think you measure… Yeah. For some reason I thought that you really see some difference between them. But no. No, I’m not sure. No.&nbsp;And I think then the key is to have a lot of this wondering. Are the other muons polarized when you shoot them into the ring? Does it matter? Muons? Yeah. When they come in. Yeah, yeah, right. Exactly. Okay, I wasn’t… It happens that in the muon decay case, this vertex is actually a weak interaction vertex and it produces a certain chirality of the state. So muons are always polarized in the decay case. That’s really pretty, right? And so this spectacular experiment is… I think the next generation of it is happening right now. And I think worth mentioning that the most important quantity, or the most important concern in the setup, is the homogeneity of the field. So once you have a little inhomogeneity, the field is not exactly <span class="math inline">B</span> , but a little bit different. So the integral over the magnetic field that the muon acquires by traveling is different and then you introduce uncertainty. And in order to achieve such precision, which is quantified in the… I don’t know if you’ve seen this… parts per billion. Yeah, that’s the precision that people talk about. So currently, how many parts per billion do you have? So we have 63 parts per billion. The uncertainty of the experimental value is 63 parts per billion. And I think the theoretical answer is similar. It’s around 100. Well, you might tell me, “Wait a second.</p>
<div id="fig-fg3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig3.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: This image shows the diagrammatic and analytic expression for the <strong>leading quantum electrodynamics (QED) correction</strong> to the muon’s anomalous magnetic moment <span class="math inline">\left(g-2\right)_\mu</span> . The Feynman diagram illustrates the process where a muon ( <span class="math inline">\mu^+</span> ) emits and reabsorbs a virtual photon ( <span class="math inline">\gamma</span> ), representing the lowest-order radiative correction to the magnetic moment. The accompanying formula, <span class="math inline">a_\mu^{\text{QED}} = \frac{\alpha}{2\pi}</span> , gives the value of this leading order correction, first calculated by Schwinger. This correction arises from quantum loops and is central to understanding the muon’s magnetic anomaly within QED. In the context of the lecture, this term forms the baseline for more complex contributions, such as hadronic vacuum polarization and hadronic light-by-light effects, which provide smaller but more uncertain corrections.
</figcaption>
</figure>
</div>
<p>I have heard this already in the particle physics course. What does hadronic physics have to do with that?” And that actually appears prominently on the series side. If you want to calculate the value of the anomalous magnetic moment from a theoretical point of view, it’s not only QED corrections that are relevant, but also other corrections, among which are electroweak, which are small. We don’t talk about them, <span class="math inline">Z</span> and <span class="math inline">W</span> . But hadronic corrections. There are two prominent hadronic contributions to the anomalous magnetic moment. One is the… So I left it in the original abbreviations. Let’s try to guess what it is. What are the letters? H, L, B L, H, vp. So H stands for hadronic. And then let me draw a diagram. This vertex… No, so for this one, the diagram is the following. So the photon produces hadrons and then turns into a photon again. And that’s a hadronic contribution. Is it vacuum or is it the running vacuum polarization? And then the first one… Let me draw it. Yeah, it’s actually nicer than, you know, boring logarithm. It’s called light-by-light scattering. So light-by-light. And what’s inside of this blob? That maybe in three ways might look confusing. But what this actually really means is: light comes in, light goes out, and then you have a hadron here and you have another hadron. Then you have another photon. So that’s the process. And then all mesons that are coupled to photons that can decay to two photons, they contribute to the hadronic light-by-light. So which meson do you know that decays to two photons? Pion. Yeah, <span class="math inline">\pi^0</span> . It’s a prominent contribution to hadronic light-by-light. And then <span class="math inline">\eta</span> is another one. So some of the scalar mesons and which hadrons are here. So the thing is that you see that the photon current wouldn’t change the quantum numbers. So there should be <span class="math inline">J^{PC}</span> of the photon. And what are hadrons that have the <span class="math inline">J^{PC}</span> of the photon? What are the quantum numbers of a photon? Spin. Perhaps you remember the spin of a photon. No doubts. The photon has spin one. So then the parity is minus. Charge conjugation is… Well, we can say it’s minus. So <span class="math inline">1^{--}</span> . What are examples of mesons that have <span class="math inline">1^{--}</span> quantum numbers? Let’s say <span class="math inline">1^-</span> . Let’s first do <span class="math inline">J^P</span> . Any 1s, 1p. I just want to remind you that there are two states in the 1s multiplet. The lower one has a bottom <span class="math inline">0^-</span> and the other one is <span class="math inline">1^-</span> . So this guy… This guy and then all others, this guy. So in this plot, on the X axis I have the quantum numbers and on the Y axis the mass or energy. And this is a quark model sketch of the excitation pattern of the mesons. So everyone should give me an example. Should you start? Vector meson. <span class="math inline">K^0</span> ? <span class="math inline">0^+</span> , <span class="math inline">0^-</span> doesn’t work. Why? Vector meson <span class="math inline">1^-</span> is a vector meson. So 1 means vector. But it’s the same thing. It’s the same spin one, it’s a vector. And <span class="math inline">\rho</span> . <span class="math inline">\rho</span> . Very good. The <span class="math inline">\rho</span> is your favorite meson. Not necessarily favorite. Give me… So if <span class="math inline">\rho</span> meson is the <span class="math inline">u \bar{u}</span> . So you, let’s say <span class="math inline">u \bar{u}</span> . We want a neutral <span class="math inline">u \bar{u}</span> . And in triplet. And this is a… where <span class="math inline">u</span> has spin up and then <span class="math inline">\bar{u}</span> has spin up. So up up. So this is <span class="math inline">u</span> . And if I replace here <span class="math inline">u</span> quark to <span class="math inline">c</span> quark, which particle do I get? This picture in the light vector in the light sector has a <span class="math inline">\rho</span> . In the charm sector, what does it have? What’s the name of this particle? Yes, <span class="math inline">J/\psi</span> . All of them are vectors. All of them are from this multiplet and 1D would also have vectors. And now strange sector. <span class="math inline">c \bar{c}</span> . What is the vector in the strange sector? No, strange <span class="math inline">c \bar{c}</span> ? Sorry. <span class="math inline">s \bar{s}</span> from what? So let others… I think let’s… Let’s ask the students. Yeah, that’s right. <span class="math inline">\phi</span> . So this is a <span class="math inline">\rho</span> , <span class="math inline">\phi</span> , <span class="math inline">\psi</span> or <span class="math inline">J/\psi</span> , and then we miss <span class="math inline">c \bar{c}</span> . Sorry, <span class="math inline">b \bar{b}</span> . Upsilon, you need <span class="math inline">d \bar{b}</span> ? Okay, what’s the vector in the bottomonium sector? No, of course. Yeah, but I tell you and then you say, “Of course I knew this,” but it’s called <span class="math inline">\Upsilon</span> . And then what do we miss? <span class="math inline">K</span> vectors in the <span class="math inline">K</span> sector would be <span class="math inline">K^*</span> , but they don’t have the flavor quantum numbers of photons. So it has a… It’s non-zero flavor. It’s a <span class="math inline">u \bar{s}</span> . A photon cannot produce <span class="math inline">u \bar{s}</span> . So fine, we need neutral flavor to appear here. And these are the main particles that actually give the most contribution, and I think maybe mixing up, but I don’t exactly remember. I think more than 50% comes from <span class="math inline">\rho</span> . It’s… We get exactly the number. I want to give an equation for how this is computed because it’s rather straightforward. You can totally understand this. It’s… So hadronic physics is a dirty business. Cannot be calculated from first principles. The way how we calculate these kinds of corrections to the anomalous magnetic moment, namely hadronic vacuum polarization, is we use the information that we measure in other places. So the photon transition to the hadrons and back is related to the <span class="math inline">e^+ e^-</span> cross section to hadrons because when <span class="math inline">e^+ e^-</span> annihilate, the quantum numbers are exactly <span class="math inline">1^{--}</span> . So we use unitarity to relate this process to the inverse. Let me just verify that the next word… It. So the way we proceed is we do a kind of mixed theoretical-experimental evaluation. We cannot calculate from first principles, but we have analyticity and unitarity, and these tools help us to relate one process to another. So it appears that the hadronic vacuum polarization contribution is actually from optical theory related to the cross section of <span class="math inline">e^+ e^-</span> to hadrons. Let’s look at this expression once again before proceeding. So ask me everything that is unclear in this expression. Let’s look at this together. <span class="math inline">\alpha</span> is the electromagnetic constant, <span class="math inline">\mu</span> mass, <span class="math inline">\mu</span> mass of the muon. Nothing surprising. I want you to pay attention to the integral and the denominator here. The kernel is a mathematical function that is related to the spin of the particles. So this appears… I mean, this is a bunch of logarithms and rational functions. It’s a kernel. If particles were scalar, <span class="math inline">K</span> would be 1, and <span class="math inline">R</span> is the experimental ratio. But I want to pay attention to this integral. So this integral has… It starts at the threshold of the hadron production reaction. So the idea is that we’re going to cut this loop and see what particles can be produced on-shell inside of this blob. The lowest threshold would give us the integration limit, and what is the lowest threshold? So what do you think is the lowest threshold in this setup? Or, like, think of a photon creating a particle, a bunch of particles on-shell. Hadrons, quarks cannot be on-shell. Yeah, that’s why two masses, even two quarks cannot be on-shell. Two pions. That’s our lightest particles that we have. Yes. So indeed we have to integrate from threshold, which is… So the lowest process that starts happening is two pions are produced. And as I mentioned, these two pions have to be… I mean, the energy-momentum is conserved. Therefore, these two pions have non-trivial orbital angular momentum to have <span class="math inline">1^{--}</span> . So then give a little thought. What orbital angular momentum for two pions to have <span class="math inline">1^-</span> ? In which wave would you combine them? Yeah, simply because S-wave would give you <span class="math inline">0^+</span> . <span class="math inline">\pi^0</span> has <span class="math inline">0^-</span> , <span class="math inline">0^-</span> plus <span class="math inline">0^-</span> together, and then when you add one unit of angular momentum, you get <span class="math inline">1^-</span> .</p>
<div id="fig-fg5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig5.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: This figure illustrates key Feynman diagrams for the hadronic contributions to the anomalous magnetic moment of the muon ( <span class="math inline">a_\mu</span> ). - <strong>Top diagram:</strong> This shows hadronic light-by-light scattering, where photons couple to hadronic states such as pions in an internal loop. This process represents the <strong>hadronic light-by-light (HLbL)</strong> contribution, involving interactions where virtual photons interact via hadronic intermediate states (e.g., pions). - <strong>Bottom diagram:</strong> This diagram depicts the <strong>hadronic vacuum polarization (HVP)</strong>, where a virtual photon splits into a hadronic state that then re-annihilates into another photon, which then couples to the muon. The annotation “vector mesons ( <span class="math inline">\rho</span> , <span class="math inline">\phi</span> , <span class="math inline">J/\psi</span> , <span class="math inline">\Upsilon</span> )” refers to the main hadronic states (neutral vector mesons with quantum numbers <span class="math inline">J^{PC}=1^{--}</span> ) that contribute most significantly to this process. In both diagrams, these hadronic effects modify the interaction of the muon with the magnetic field, producing corrections that are essential for precise theoretical predictions of <span class="math inline">g-2</span> . These contributions are difficult to calculate from first principles and are the primary source of uncertainty in the Standard Model prediction for <span class="math inline">a_\mu</span> .
</figcaption>
</figure>
</div>
<p>So this construction hopefully will become familiar in a few minutes when you integrate from threshold to infinity and you have a <span class="math inline">1/s</span> denominator. And that’s what I would like to just explain by introducing this dispersion relation.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Hadronic Contributions to <span class="math inline">a_\mu</span> :</strong> The two main hadronic contributions are:</p>
<ol type="1">
<li><strong>Hadronic Vacuum Polarization (HVP):</strong> A photon fluctuates into a hadronic state (e.g., <span class="math inline">\rho</span> , <span class="math inline">\omega</span> , <span class="math inline">\phi</span> mesons) and back.</li>
<li><strong>Hadronic Light-by-Light Scattering (HLbL):</strong> A photon interacts via a hadronic intermediate state that couples to two photons (e.g., <span class="math inline">\pi^0</span> , <span class="math inline">\eta</span> ).</li>
</ol>
<p>The photon has quantum numbers <span class="math inline">J^{PC} = 1^{--}</span> , so the dominant HVP contributions come from neutral vector mesons with the same quantum numbers: <span class="math inline">\rho^0</span> , <span class="math inline">\omega</span> , <span class="math inline">\phi</span> , <span class="math inline">J/\psi</span> , <span class="math inline">\Upsilon</span> .</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Calculating the Hadronic Vacuum Polarization:</strong> Because we cannot calculate hadronic processes from first principles, the HVP contribution is determined using a dispersion relation that connects it to the experimentally measured cross section for <span class="math inline">e^+e^- \to \text{hadrons}</span> , via the <span class="math inline">R</span> -ratio. <span class="math display">a_{\mu}^{\text{HVP}} = \left(\frac{\alpha m_{\mu}}{3\pi}\right)^{2} \int_{s_{\text{th}}}^{\infty} \frac{ds'}{s'} K(s') R(s')</span><br>
where <span class="math inline">R(s) = \sigma(e^{+}e^{-} \to \text{hadrons}) / \sigma_{0}(e^{+}e^{-} \to \mu^{+}\mu^{-})</span> and <span class="math inline">s_{\text{th}} = (2m_\pi)^2</span> is the two-pion production threshold.</p>
</div>
</div>
</div>
</section>
<section id="dispersion-relations-and-analytic-continuation" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="dispersion-relations-and-analytic-continuation"><span class="header-section-number">2</span> Dispersion Relations and Analytic Continuation</h2>
<p>The Cauchy theorem tells us that in the complex plane, you can integrate within the domain of analyticity. The integral of an analytic function over a closed contour is equal to the sum of the <span class="math inline">2\pi i</span> residues of the function at the poles inside the contour.</p>
<p>This should look familiar. We’ve already discussed that you can use this to obtain an integral representation for any function within its domain of analyticity. You can write this in the following way, which is what you do manually by hand—introducing a pole so that the integral equals the residue of the integrand.</p>
<p>So, for a function <span class="math inline">F(s)</span> that is a ratio with one pole, the integral will be equal to the residue at that pole. This requires substituting <span class="math inline">s</span> for <span class="math inline">s'</span> at the pole to complete the derivation.</p>
<p>This is known as the <strong>Cauchy integral formula</strong>, and what follows is a consequence of it. There is a useful trick, especially for analytic functions.</p>
<p>Imagine you have a function that is real analytic in a domain below a cut, with the cut starting at some threshold. We would like to use a similar method to evaluate its value.</p>
<p>What I’m going to do is write the Cauchy representation for a contour: <span class="math display">G(s) = \frac{1}{2\pi i} \oint_C \frac{G(s')}{s' - s} \, ds'.</span></p>
<p>Now, I will deform or “blow up” the contour. Changing the contour does not change the integral’s value, provided we account for singularities. The only singularity encountered is the simple pole of the integrand at <span class="math inline">s' = s</span> .</p>
<p>When I deform the contour, it acquires two contributions:</p>
<ol type="1">
<li>A contribution from a large circle at infinity.</li>
<li>A contribution from integrating along the cut.</li>
</ol>
<p>The contribution from the cut is evaluated along the real axis. I will use the property of the discontinuity across the cut: <span class="math display">G(s + i\epsilon) - G(s - i\epsilon) = 2i \, \operatorname{Im} G(s),</span><br>
where <span class="math inline">\epsilon</span> is infinitesimal. This relation follows from real analyticity.</p>
<p>This might seem intuitively clear, but let’s consider an example. Take a function with a cut starting at <span class="math inline">x=1</span> and extending to the right, which is real analytic elsewhere. A good example is <span class="math inline">\sqrt{1 - x}</span> .</p>
<ul>
<li>For <span class="math inline">x &lt; 1</span> , e.g., <span class="math inline">x = 0</span> , <span class="math inline">\sqrt{1 - 0} = 1</span> (real).</li>
<li>For <span class="math inline">x &gt; 1</span> , e.g., <span class="math inline">x = 5</span> , <span class="math inline">\sqrt{1 - 5} = \sqrt{-4} = 2i</span> . Here, <span class="math inline">G(5 + i0)</span> has a positive imaginary part.</li>
</ul>
<div id="fig-fg6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fg6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="2024-Lecture-12-images/fig6.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fg6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: This diagram depicts the analytic structure of a complex function in the context of dispersion relations, relevant for hadronic contributions to the muon anomalous magnetic moment ( <span class="math inline">a_\mu</span> ). The figure shows the complex <span class="math inline">s</span> -plane, with a branch cut (wiggly line) starting from the hadronic production threshold <span class="math inline">s_{\text{thr}}</span> and extending to higher <span class="math inline">s</span> along the real axis. A closed contour is drawn around the singularity structure, avoiding the cut, which is a standard setup in the application of the Cauchy integral theorem and for deriving dispersion relations. Physically, this illustrates how the analytic properties of the vacuum polarization function <span class="math inline">\Pi(q^2)</span> allow us to relate its values at any <span class="math inline">s</span> in the complex plane to its imaginary part (and thus the experimental cross section, via the optical theorem) along the cut. The lower bound <span class="math inline">s_{\text{thr}}</span> represents the physical threshold for hadron production, such as <span class="math inline">2m_\pi</span> for two-pion states. The dispersion relation integral runs along the cut starting at this threshold, and the contribution from the large circle at infinity vanishes if the function falls off rapidly enough. In summary, the contour encapsulates the foundational mathematical relation underlying the use of experimental <span class="math inline">R(s)</span> data in precision Standard Model predictions of <span class="math inline">a_\mu</span> .
</figcaption>
</figure>
</div>
<p>For a real analytic function, the values above and below the cut have the same real part and opposite imaginary parts. This discontinuity lets me rewrite the contour integral. If the function decays sufficiently fast as <span class="math inline">|s| \to \infty</span> , the contribution from the large circle vanishes.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The key relation used here is the <strong>discontinuity across a cut</strong>: <span class="math display">G(s + i\epsilon) - G(s - i\epsilon) = 2i \, \operatorname{Im} G(s).</span><br>
This underpins the derivation of dispersion relations, allowing us to connect the real and imaginary parts of an analytic function.</p>
</div>
</div>
</div>
<p>Accounting for the direction of integration along the cut (which introduces a minus sign) and the factor of <span class="math inline">2i</span> from the discontinuity, we arrive at a beautiful formula known as a <strong>dispersion relation</strong>: <span class="math display">G(s) = \frac{1}{\pi} \int_{\text{cut}} \frac{\operatorname{Im} G(s')}{s' - s} \, ds'.</span></p>
<p>This is quite amazing—it allows us to recover the full analytic function from just its imaginary part along the cut. Using this relation, I can determine the function anywhere in the complex plane. This is an advanced subject, but it’s part of our classwork as an exercise to understand how dispersion works.</p>
<p>Sometimes, the function does not decay fast enough at infinity for the unsubtracted relation to converge. In such cases, we use a <strong>subtracted dispersion relation</strong>.</p>
<ul>
<li><p><strong>Once-Subtracted Relation:</strong> We introduce a subtraction at a point <span class="math inline">s = a</span> : <span class="math display">G(s) = G(a) + \frac{s - a}{\pi} \int_{\text{cut}} \frac{\operatorname{Im} G(s')}{(s' - a)(s' - s)} \, ds'.</span><br>
The term <span class="math inline">G(a)</span> ensures the relation remains correct when <span class="math inline">s = a</span> .</p></li>
<li><p><strong>A Common Simplification:</strong> The easiest subtraction is at zero ( <span class="math inline">a = 0</span> ): <span class="math display">G(s) = G(0) + \frac{s}{\pi} \int \frac{\operatorname{Im} G(s')}{s'(s' - s)} \, ds'.</span></p></li>
</ul>
<p>If once is not enough, you can perform a twice-subtracted dispersion relation. It’s remarkable that this works.</p>
<p>Let’s test this with our example, <span class="math inline">\sqrt{1 - x}</span> . Its imaginary part appears only for <span class="math inline">x &gt; 1</span> . The dispersion relation with one subtraction at zero (where <span class="math inline">G(0) = 1</span> ) would state: <span class="math display">\sqrt{1 - x} = 1 + \frac{x}{\pi} \int_{1}^{\infty} \frac{\operatorname{Im} \sqrt{1 - s'}}{s'(s' - x)} \, ds'.</span><br>
It’s non-trivial to believe, but it holds mathematically because we started with an analytic function and used the Cauchy integral. The imaginary part of <span class="math inline">\sqrt{1 - x}</span> for <span class="math inline">x &gt; 1</span> is simply <span class="math inline">\sqrt{x - 1}</span> , leading to a valid, if surprising, identity.</p>
</section>
<section id="hadronic-contributions-and-the-muon-anomaly" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="hadronic-contributions-and-the-muon-anomaly"><span class="header-section-number">3</span> Hadronic Contributions and the Muon Anomaly</h2>
<p>Now we finally come back in the last minutes to the expression and I’ll wrap up this sketch of how it works. We relate the imaginary part of the forward scattering amplitude, through the <strong>optical theorem</strong>, to the total cross section. The observable is given by the cross section. The cross section is proportional to the imaginary part. You put the imaginary part in the numerator of a dispersion integral, and we have this contribution.</p>
<p>It probably makes more sense now why we start the integral at the production threshold, and why we use this global function. Back to the <strong>vacuum polarization function</strong> <span class="math inline">\Pi(q^2)</span> : it is an analytic function and it only has a <strong>right-hand cut</strong>. It’s real analytic below threshold. Once we go above the threshold, it starts having an imaginary part. We compute this polarization by a <strong>dispersion relation</strong> and then relate it to the cross section.</p>
<p>The key quantity is the ** <span class="math inline">R</span> -ratio<strong>, <span class="math inline">R(s)</span> . It is defined as: <span class="math display">R(s) = \frac{\sigma(e^{+}e^{-} \to \text{hadrons})}{\sigma_{0}(e^{+}e^{-} \to \mu^{+}\mu^{-})}</span><br>
The denominator is the point-like <span class="math inline">\mu^+ \mu^-</span> cross section. For the <span class="math inline">R</span> -ratio we need in the dispersion integral, a high-precision </strong>three‑loop theoretical calculation** is used. This calculation is very close to what we measure in experiment. The exercise sheet gives you the small differences to explore.</p>
<p>But the experimental <span class="math inline">R(s)</span> really shows all the resonances that can pop up. A plot of the experimental measurement is quite spectacular, as we expect. It has contributions from all these resonances: you see the <span class="math inline">\rho</span> , the <span class="math inline">\phi</span> , the <span class="math inline">\Upsilon</span> . They all sit on a continuous background. This background comes from all possible hadronic contributions—quarks that hadronize not into single pions, but into multi-particle states (pions, etc.) needed to evaluate this contribution.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The imaginary part of the vacuum polarization is directly proportional to the <span class="math inline">R</span> -ratio: <span class="math display">\operatorname{Im} \Pi(s) = \frac{\alpha}{3} R(s)</span><br>
This allows experimental <span class="math inline">R(s)</span> data to be fed into the dispersion integral for <span class="math inline">\Pi(q^2)</span> . The current status is that there is about a <strong>five‑sigma mismatch</strong> between the full Standard Model theory prediction and the experimental measurement of the muon’s anomalous magnetic moment, <span class="math inline">a_\mu = (g-2)_\mu/2</span> . (see <a href="#fig-fg5" class="quarto-xref">Figure&nbsp;5</a>) This tension was more prominent a few years ago, before some issues in QED calculations were discovered, and it was considered a potential indication for <strong>new physics</strong>. The precision is at the level of tens of <strong>parts per billion</strong>.</p>
</div>
</div>
</div>
<p>In recent years, two developments have threatened this new physics interpretation:</p>
<ol type="1">
<li><strong>Lattice QCD calculations</strong> of the hadronic vacuum polarization (HVP). Lattice groups calculate part of this quantity in a different domain (Euclidean time) and their results <strong>disagree</strong> with the phenomenological calculations that use dispersion relations and experimental <span class="math inline">R(s)</span> data.</li>
<li>New experimental data from the <strong>CMD experiment</strong> in Novosibirsk, which claims measurements in the critical energy region are inconsistent with past experiments but consistent with the experimental <span class="math inline">g-2</span> value if used in the analysis.</li>
</ol>
<p>Consequently, the five‑sigma discrepancy is now shrinking (e.g., to 1.8 sigma with some new lattice data). The indication for new physics is getting weaker, but it remains a significant puzzle.</p>
<p>There is a major ongoing effort:</p>
<ul>
<li><p>New experimental facilities are being built to measure <span class="math inline">R(s)</span> more precisely.</p></li>
<li><p>There is a large theoretical effort to properly calculate the <strong>hadronic effects</strong>, which remain the main source of uncertainty.</p></li>
<li><p>The leading-order HVP contribution to <span class="math inline">a_\mu</span> is: <span class="math display">a_\mu^{\text{HVP}} = \frac{\alpha^2}{3\pi^2} \int_{s_{\text{th}}}^\infty \frac{ds}{s} K(s) R(s)</span></p></li>
<li><p>The <strong>Hadronic Light-by-Light (HLbL)</strong> scattering contribution is even more difficult, as it involves virtual photons and their <span class="math inline">Q^2</span> dependence.</p></li>
</ul>
<p><strong>I think we’re done. So, questions. We have time for questions. Finally.</strong></p>
<p>One note I’d like to clarify for myself: when fitting these oscillatory components, do you extract the full amplitude <span class="math inline">W</span> or just the difference between them? I’ve seen potential typos in papers on the vacuum polarization expression and will clarify with colleagues. But roughly, that’s it. Now you have a bare idea so when you hear <strong>HLbL</strong> and <strong>HVP</strong>, you know what they mean. Thanks for coming.</p>
<p><strong>One short question from the audience:</strong></p>
<blockquote class="blockquote">
<p><strong>Q:</strong> Why can’t we be sure the main contributions are hadronic? Aren’t the ones we evaluate correctly just smaller?</p>
</blockquote>
<p><strong>A:</strong> That’s a good point. I may have misspoken. The hadronic contributions are not necessarily the largest in magnitude, but they have the <strong>leading uncertainty</strong>. They are difficult to calculate to the precision required to reduce the overall uncertainty further. For instance, the HVP contribution, which is around 600 parts per billion, has been refined to about 100-200 ppb, but its uncertainty still dominates. (see <a href="#fig-fg5" class="quarto-xref">Figure&nbsp;5</a>) We know other contributions (like pure QED) much better—they are smaller <em>and</em> have smaller uncertainties. The HLbL contribution is notoriously difficult, with many terms and a complex dependence on virtual photon momenta.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>